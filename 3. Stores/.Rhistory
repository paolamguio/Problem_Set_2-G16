table(oversampled_data$Pobre)
table(oversampled_data2$Pobre)
table(oversampled_data$Pobre)
oversampled_data <- smote_output$data
table(oversampled_data$Pobre)
smote_output = SMOTE(X = trainX,
target = training$Pobre)
oversampled_data <- smote_output$data
table(oversampled_data$Pobre)
View(smote_output)
predictors(trainX)
smote_output = SMOTE(X = trainX,
target = training$Pobre)
oversampled_data <- smote_output$data
table(oversampled_data$Pobre)
require("smotefamily")
table(oversampled_data2$Pobre)
oversampled_data <- smote_output$data
table(oversampled_data$Pobre)
predictors<-model
head(training[predictors])
predictors<-c(model)
head(training[predictors])
set.seed(1410)
logit_lasso_smote <- train(
model,
data = oversampled_data,
method = "glmnet",
trControl = ctrl,
family = "binomial",
metric = "Spec",
tuneGrid = expand.grid(alpha = 0,lambda=lambda_grid),
preProcess = c("center", "scale")
)
require("smotefamily")
trainX<-data.frame(model.matrix(model,data=training))[-1]
trainX2<-data.frame(model.matrix(model2,data=training))[-1]
smote_output = SMOTE(X = trainX,
target = training$Pobre)
smote_output2 = SMOTE(X = trainX2,
target = training$Pobre)
oversampled_data <- smote_output$data
oversampled_data2 <- smote_output$data2
table(oversampled_data$Pobre)
table(oversampled_data2$Pobre)
set.seed(1410)
logit_lasso_smote <- train(
model,
data = oversampled_data,
method = "glmnet",
trControl = ctrl,
family = "binomial",
metric = "Spec",
tuneGrid = expand.grid(alpha = 0,lambda=lambda_grid),
preProcess = c("center", "scale")
)
logit_lasso_smote
logit_ridge_smote <- train(
model,
data = oversampled_data,
method = "glmnet",
trControl = ctrl,
family = "binomial",
metric = "Spec",
tuneGrid = expand.grid(alpha = 1,lambda=lambda_grid),
preProcess = c("center", "scale")
)
logit_elasticnet_smote2 <- train(
model2,
data = oversampled_data2,
method = "glmnet",
trControl = ctrl,
family = "binomial",
metric = "Spec",
preProcess = c("center", "scale")
)
evalResults <- data.frame(Pobre = testing$Pobre)
evalResults <- data.frame(Pobre = evaluation$Pobre)
evalResults$Roc_logit <- predict(logit,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit2 <- predict(logit2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_lasso <- predict(logit_lasso,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_lasso2 <- predict(logit_lasso2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_ridge <- predict(logit_ridge,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_ridge2 <- predict(logit_ridge2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_elasticnet <- predict(logit_elasticnet,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_elasticnet2 <- predict(logit_elasticnet2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_lasso_upsample <- predict(logit_lasso_upsample,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_lasso_upsample2 <- predict(logit_lasso_upsample2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_ridge_upsample <- predict(logit_ridge_upsample,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_ridge_upsample2 <- predict(logit_ridge_upsample2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_elasticnet_upsample <- predict(logit_elasticnet_upsample,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_elasticnet_upsample2 <- predict(logit_elasticnet_upsample2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_lasso_downsample <- predict(logit_lasso_downsample,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_lasso_downsample2 <- predict(logit_lasso_downsample2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_ridge_downsample <- predict(logit_ridge_downsample,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_ridge_downsample2 <- predict(logit_ridge_downsample2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_elasticnet_downsample <- predict(logit_elasticnet_downsample,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_elasticnet_downsample2 <- predict(logit_elasticnet_downsample2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_laso_smote <- predict(logit_lasso_smote,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_laso_smote2 <- predict(logit_lasso_smote2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_ridge_smote <- predict(logit_ridge_smote,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_ridge_smote2 <- predict(logit_ridge_smote2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_elasticnet_smote <- predict(logit_elasticnet_smote,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_elasticnet_smote2 <- predict(logit_elasticnet_smote2,
newdata = evaluation,
type = "prob")[,1]
evalResults <- data.frame(Pobre = evaluation$Pobre)
evalResults$Roc_logit <- predict(logit,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit2 <- predict(logit2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_lasso <- predict(logit_lasso,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_lasso2 <- predict(logit_lasso2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_ridge <- predict(logit_ridge,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_ridge2 <- predict(logit_ridge2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_elasticnet <- predict(logit_elasticnet,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_elasticnet2 <- predict(logit_elasticnet2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_lasso_upsample <- predict(logit_lasso_upsample,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_lasso_upsample2 <- predict(logit_lasso_upsample2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_ridge_upsample <- predict(logit_ridge_upsample,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_ridge_upsample2 <- predict(logit_ridge_upsample2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_elasticnet_upsample <- predict(logit_elasticnet_upsample,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_elasticnet_upsample2 <- predict(logit_elasticnet_upsample2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_lasso_downsample <- predict(logit_lasso_downsample,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_lasso_downsample2 <- predict(logit_lasso_downsample2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_ridge_downsample <- predict(logit_ridge_downsample,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_ridge_downsample2 <- predict(logit_ridge_downsample2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_elasticnet_downsample <- predict(logit_elasticnet_downsample,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_elasticnet_downsample2 <- predict(logit_elasticnet_downsample2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_laso_smote <- predict(logit_lasso_smote,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_laso_smote2 <- predict(logit_lasso_smote2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_ridge_smote <- predict(logit_ridge_smote,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_ridge_smote2 <- predict(logit_ridge_smote2,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_elasticnet_smote <- predict(logit_elasticnet_smote,
newdata = evaluation,
type = "prob")[,1]
evalResults$Roc_logit_elasticnet_smote2 <- predict(logit_elasticnet_smote2,
newdata = evaluation,
type = "prob")[,1]
rfROC_logit <- roc(evalResults$Pobre, evalResults$Roc_logit, levels = rev(levels(evalResults$Pobre)))
rfROC_logit2 <- roc(evalResults$Pobre, evalResults$Roc_logit2, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_lasso <- roc(evalResults$Pobre, evalResults$Roc_logit_lasso, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_lasso2 <- roc(evalResults$Pobre, evalResults$Roc_logit_lasso2, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_ridge <- roc(evalResults$Pobre, evalResults$Roc_logit_ridge, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_ridge2 <- roc(evalResults$Pobre, evalResults$Roc_logit_ridge2, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_elasticnet <- roc(evalResults$Pobre, evalResults$Roc_logit_elasticnet, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_elasticnet2 <- roc(evalResults$Pobre, evalResults$Roc_logit_elasticnet2, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_lasso_upsample <- roc(evalResults$Pobre, evalResults$Roc_logit_lasso_upsample, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_lasso_upsample2 <- roc(evalResults$Pobre, evalResults$Roc_logit_lasso_upsample2, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_ridge_upsample <- roc(evalResults$Pobre, evalResults$Roc_logit_ridge_upsample, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_ridge_upsample2 <- roc(evalResults$Pobre, evalResults$Roc_logit_ridge_upsample2, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_elasticnet_upsample <- roc(evalResults$Pobre, evalResults$Roc_logit_elasticnet_upsample, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_elasticnet_upsample2 <- roc(evalResults$Pobre, evalResults$Roc_logit_elasticnet_upsample2, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_lasso_downsample <- roc(evalResults$Pobre, evalResults$Roc_logit_lasso_downsample, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_lasso_downsample2 <- roc(evalResults$Pobre, evalResults$Roc_logit_lasso_downsample2, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_ridge_downsample <- roc(evalResults$Pobre, evalResults$Roc_logit_ridge_downsample, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_ridge_downsample2 <- roc(evalResults$Pobre, evalResults$Roc_logit_ridge_downsample2, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_elasticnet_downsample <- roc(evalResults$Pobre, evalResults_Roc_logit_elasticnet_downsample, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_elasticnet_downsample2 <- roc(evalResults$Pobre, evalResults_Roc_logit_elasticnet_downsample2, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_lasso_smote <- roc(evalResults$Pobre, evalResults$Roc_logit_lasso_smote, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_lasso_smote2 <- roc(evalResults$Pobre, evalResults$Roc_logit_lasso_smote2, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_ridge_smote <- roc(evalResults$Pobre, evalResults$Roc_logit_ridge_smote, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_ridge_smote2 <- roc(evalResults$Pobre, evalResults$Roc_logit_ridge_smote2, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_elasticnet_smote <- roc(evalResults$Pobre, evalResults$Roc_logit_elasticnet_smote, levels = rev(levels(evalResults$Pobre)))
rfROC_logit_elasticnet_smote2 <- roc(evalResults$Pobre, evalResults$Roc_logit_elasticnet_smote2, levels = rev(levels(evalResults$Pobre)))
rfROC_logit <- roc(evalResults$Pobre, evalResults$Roc_logit, levels = rev(levels(evalResults$Pobre)))
rfROC_logit <- roc(evalResults$Pobre, evalResults$Roc_logit, levels = rev(levels(evalResults$Pobre)))
rfROC_logit
rfThresh_logit <- coords(rfROC_logit, x = "best", best.method = "closest.topleft")
rfThresh_logit
rfROC_logit
rfThresh_logit2 <- coords(rfROC_logit2, x = "best", best.method = "closest.topleft")
rfThresh_logit2
rfThresh_logit_lasso <- coords(rfROC_logit_lasso, x = "best", best.method = "closest.topleft")
rfThresh_logit_lasso
rfThresh_logit_lasso2 <- coords(rfROC_logit_lasso2, x = "best", best.method = "closest.topleft")
rfThresh_logit_lasso2
rfThresh_logit_ridge <- coords(rfROC_logit_ridge, x = "best", best.method = "closest.topleft")
rfThresh_logit_ridge
rfThresh_logit_ridge2 <- coords(rfROC_logit_ridge2, x = "best", best.method = "closest.topleft")
rfThresh_logit_ridge2
rfThresh_logit_elasticnet <- coords(rfROC_logit_elasticnet, x = "best", best.method = "closest.topleft")
rfThresh_logit_elasticnet
rfThresh_logit_elasticnet2 <- coords(rfROC_logit_elasticnet2, x = "best", best.method = "closest.topleft")
rfThresh_logit_elasticnet2
rfThresh_logit_lasso_upsample <- coords(rfROC_logit_lasso_upsample, x = "best", best.method = "closest.topleft")
rfThresh_logit_lasso_upsample
rfThresh_logit_lasso_upsample2 <- coords(rfROC_logit_lasso_upsample2, x = "best", best.method = "closest.topleft")
rfThresh_logit_lasso_upsample2
rfThresh_logit_ridge_upsample <- coords(rfROC_logit_ridge_upsample, x = "best", best.method = "closest.topleft")
rfThresh_logit_ridge_upsample
rfThresh_logit_ridge_upsample2 <- coords(rfROC_logit_ridge_upsample2, x = "best", best.method = "closest.topleft")
rfThresh_logit_ridge_upsample2
rfThresh_logit_elasticnet_upsample <- coords(rfROC_logit_elasticnet_upsample, x = "best", best.method = "closest.topleft")
rfThresh_logit_elasticnet_upsample
rfThresh_logit_elasticnet_upsample2 <- coords(rfROC_logit_elasticnet_upsample2, x = "best", best.method = "closest.topleft")
rfThresh_logit_elasticnet_upsample2
rfThresh_logit_lasso_downsample <- coords(rfROC_logit_lasso_downsample, x = "best", best.method = "closest.topleft")
rfThresh_logit_lasso_downsample
rfThresh_logit_lasso_downsample2 <- coords(rfROC_logit_lasso_downsample2, x = "best", best.method = "closest.topleft")
rfThresh_logit_lasso_downsample
rfThresh_logit_lasso_downsample2 <- coords(rfROC_logit_lasso_downsample2, x = "best", best.method = "closest.topleft")
rfThresh_logit_lasso_downsample2
rfThresh_logit_ridge_downsample <- coords(rfROC_logit_ridge_downsample, x = "best", best.method = "closest.topleft")
erfThresh_logit_ridge_downsample
rfThresh_logit_ridge_downsample2 <- coords(rfROC_logit_ridge_downsample2, x = "best", best.method = "closest.topleft")
rfThresh_logit_ridge_downsample2
rfThresh_logit_ridge_downsample <- coords(rfROC_logit_ridge_downsample, x = "best", best.method = "closest.topleft")
rfThresh_logit_ridge_downsample
rfThresh_logit_ridge_downsample2 <- coords(rfROC_logit_ridge_downsample2, x = "best", best.method = "closest.topleft")
rfThresh_logit_ridge_downsample2
rfThresh_logit_elasticnet_downsample <- coords(rfROC_logit_elasticnet_downsample, x = "best", best.method = "closest.topleft")
rfThresh_logit_elasticnet_downsample
rfThresh_logit_elasticnet_downsample2 <- coords(rfROC_logit_elasticnet_downsample2, x = "best", best.method = "closest.topleft")
rfThresh_logit_elasticnet_downsample2
rfThresh_logit_lasso_smote <- coords(rfROC_logit_lasso_smote, x = "best", best.method = "closest.topleft")
rfThresh_logit_ridge_smote <- coords(rfROC_logit_ridge_smote, x = "best", best.method = "closest.topleft")
rfThresh_logit_ridge_smote
rfThresh_logit_ridge_smote2 <- coords(rfROC_logit_ridge_smote2, x = "best", best.method = "closest.topleft")
rfThresh_logit_ridge_smote2
rfThresh_logit_elasticnet_smote <- coords(rfROC_logit_elasticnet_smote, x = "best", best.method = "closest.topleft")
rfThresh_logit_elasticnet_smote
rfThresh_logit_elasticnet_smote2 <- coords(rfROC_logit_elasticnet_smote2, x = "best", best.method = "closest.topleft")
rfThresh_logit_elasticnet_smote2
evalResults<-evalResults %>% mutate(hat_pobre_05_logit=ifelse(evalResults$Roc_logit>0.5,"Si","No"),
hat_pobre_rfThresh_logit=ifelse(evalResults$Roc_logit>rfThresh_logit$threshold,"Si","No"),
hat_pobre_05_logit2=ifelse(evalResults$Roc_logit2>0.5,"Si","No"),
hat_pobre_rfThresh_logit2=ifelse(evalResults$Roc_logit2>rfThresh_logit2$threshold,"Si","No"),
hat_pobre_05_logit_lasso=ifelse(evalResults$Roc_logit_lasso>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso=ifelse(evalResults$Roc_logit_lasso>rfThresh_logit_lasso$threshold,"Si","No"),
hat_pobre_05_logit_lasso2=ifelse(evalResults$Roc_logit_lasso2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso2=ifelse(evalResults$Roc_logit_lasso2>rfThresh_logit_lasso2$threshold,"Si","No"),
hat_pobre_05_logit_ridge=ifelse(evalResults$Roc_logit_ridge>0.5,"Si","No"),
hat_pobre_rfThresh_logit_ridge=ifelse(evalResults$Roc_logit_ridge>rfThresh_logit_ridge$threshold,"Si","No"),
hat_pobre_05_logit_ridge2=ifelse(evalResults$Roc_logit_ridge2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_ridge2=ifelse(evalResults$Roc_logit_ridge2>rfThresh_logit_ridge2$threshold,"Si","No"),
hat_pobre_05_logit_elasticnet=ifelse(evalResults$Roc_logit_elasticnet>0.5,"Si","No"),
hat_pobre_rfThresh_logit_elasticnet=ifelse(evalResults$Roc_logit_elasticnet>rfThresh_logit_elasticnet$threshold,"Si","No"),
hat_pobre_05_logit_elasticnet2=ifelse(evalResults$Roc_logit_elasticnet2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_elasticnet2=ifelse(evalResults$Roc_logit_elasticnet2>rfThresh_logit_elasticnet2$threshold,"Si","No"),
hat_pobre_05_logit_lasso_upsample=ifelse(evalResults$Roc_logit_lasso_upsample>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso_upsample=ifelse(evalResults$Roc_logit_lasso_upsample>rfThresh_logit_lasso_upsample$threshold,"Si","No"),
hat_pobre_05_logit_lasso_upsample2=ifelse(evalResults$Roc_logit_lasso_upsample2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso_upsample2=ifelse(evalResults$Roc_logit_lasso_upsample2>rfThresh_logit_lasso_upsample2$threshold,"Si","No"),
hat_pobre_05_logit_ridge_upsample=ifelse(evalResults$Roc_logit_ridge_upsample>0.5,"Si","No"),
hat_pobre_rfThresh_logit_ridge_upsample=ifelse(evalResults$Roc_logit_ridge_upsample>rfThresh_logit_ridge_upsample$threshold,"Si","No"),
hat_pobre_05_logit_ridge_upsample2=ifelse(evalResults$Roc_logit_ridge_upsample2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_ridge_upsample2=ifelse(evalResults$Roc_logit_ridge_upsample2>rfThresh_logit_ridge_upsample2$threshold,"Si","No"),
hat_pobre_05_logit_elasticnet_upsample=ifelse(evalResults$Roc_logit_elasticnet_upsample>0.5,"Si","No"),
hat_pobre_rfThresh_logit_elasticnet_upsample=ifelse(evalResults$Roc_logit_elasticnet_upsample>rfThresh_logit_elasticnet_upsample$threshold,"Si","No"),
hat_pobre_05_logit_elasticnet_upsample2=ifelse(evalResults$Roc_logit_elasticnet_upsample2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_elasticnet_upsample2=ifelse(evalResults$Roc_logit_elasticnet_upsample2>rfThresh_logit_elasticnet_upsample2$threshold,"Si","No"),
hat_pobre_05_logit_lasso_downsample=ifelse(evalResults$Roc_logit_lasso_downsample>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso_downsample=ifelse(evalResults$Roc_logit_lasso_downsample>rfThresh_logit_lasso_downsample$threshold,"Si","No"),
hat_pobre_05_logit_lasso_downsample2=ifelse(evalResults$Roc_logit_lasso_downsample2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso_downsample2=ifelse(evalResults$Roc_logit_lasso_downsample2>rfThresh_logit_lasso_downsample2$threshold,"Si","No"),
hat_pobre_05_logit_ridge_downsample=ifelse(evalResults$Roc_logit_ridge_downsample>0.5,"Si","No"),
hat_pobre_rfThresh_logit_ridge_downsample=ifelse(evalResults$Roc_logit_ridge_downsample>rfThresh_logit_ridge_downsample$threshold,"Si","No"),
hat_pobre_05_logit_ridge_downsample2=ifelse(evalResults$Roc_logit_ridge_downsample2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_ridge_downsample2=ifelse(evalResults$Roc_logit_ridge_downsample2>rfThresh_logit_ridge_downsample2$threshold,"Si","No"),
hat_pobre_05_logit_elasticnet_downsample=ifelse(evalResults$Roc_logit_elasticnet_downsample>0.5,"Si","No"),
hat_pobre_rfThresh_logit_elasticnet_downsample=ifelse(evalResults$Roc_logit_elasticnet_downsample>rfThresh_logit_elasticnet_downsample$threshold,"Si","No"),
hat_pobre_05_logit_elasticnet_downsample2=ifelse(evalResults$Roc_logit_elasticnet_downsample2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_elasticnet_downsample2=ifelse(evalResults$Roc_logit_elasticnet_downsample2>rfThresh_logit_elasticnet_downsample2$threshold,"Si","No"),
hat_pobre_05_logit_lasso_smote=ifelse(evalResults$Roc_logit_lasso_smote>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso_smote=ifelse(evalResults$Roc_logit_lasso_smote>rfThresh_logit_lasso_smote$threshold,"Si","No"),
hat_pobre_05_logit_lasso_smote2=ifelse(evalResults$Roc_logit_lasso_smote2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso_smote2=ifelse(evalResults$Roc_logit_lasso_smote2>rfThresh_logit_lasso_smote2$threshold,"Si","No"),
hat_pobre_05_logit_ridge_smote=ifelse(evalResults$Roc_logit_ridge_smote>0.5,"Si","No"),
hat_pobre_rfThresh_logit_ridge_smote=ifelse(evalResults$Roc_logit_ridge_smote>rfThresh_logit_ridge_smote$threshold,"Si","No"),
hat_pobre_05_logit_ridge_smote2=ifelse(evalResults$Roc_logit_ridge_smote2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_ridge_smote2=ifelse(evalResults$Roc_logit_ridge_smote2>rfThresh_logit_ridge_smote2$threshold,"Si","No"),
hat_pobre_05_logit_elasticnet_smote=ifelse(evalResults$Roc_logit_elasticnet_smote>0.5,"Si","No"),
hat_pobre_rfThresh_logit_elasticnet_smote=ifelse(evalResults$Roc_logit_elasticnet_smote>rfThresh_logit_elasticnet_smote$threshold,"Si","No"),
hat_pobre_05_logit_elasticnet_smote2=ifelse(evalResults$Roc_logit_elasticnet_smote2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_elasticnet_smote2=ifelse(evalResults$Roc_logit_elasticnet_smote2>rfThresh_logit_elasticnet_smote2$threshold,"Si","No"))
with(evalResults,table(Pobre,hat_pobre_05_logit))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit))
with(evalResults,table(Pobre,hat_pobre_05_logit2))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit2))
with(evalResults,table(Pobre,hat_pobre_05_logit_lasso))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_lasso))
with(evalResults,table(Pobre,hat_pobre_05_logit_lasso2))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_lasso2))
with(evalResults,table(Pobre,hat_pobre_05_logit_ridge))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_ridge))
with(evalResults,table(Pobre,hat_pobre_05_logit_ridge2))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_ridge2))
with(evalResults,table(Pobre,hat_pobre_05_logit_elasticnet))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_elasticnet))
with(evalResults,table(Pobre,hat_pobre_05_logit_elasticnet2))
evalResults<-evalResults %>% mutate(hat_pobre_05_logit=ifelse(evalResults$Roc_logit>0.5,"Si","No"),
hat_pobre_rfThresh_logit=ifelse(evalResults$Roc_logit>rfThresh_logit$threshold,"Si","No"),
hat_pobre_05_logit2=ifelse(evalResults$Roc_logit2>0.5,"Si","No"),
hat_pobre_rfThresh_logit2=ifelse(evalResults$Roc_logit2>rfThresh_logit2$threshold,"Si","No"),
hat_pobre_05_logit_lasso=ifelse(evalResults$Roc_logit_lasso>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso=ifelse(evalResults$Roc_logit_lasso>rfThresh_logit_lasso$threshold,"Si","No"),
hat_pobre_05_logit_lasso2=ifelse(evalResults$Roc_logit_lasso2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso2=ifelse(evalResults$Roc_logit_lasso2>rfThresh_logit_lasso2$threshold,"Si","No"),
hat_pobre_05_logit_elasticnet=ifelse(evalResults$Roc_logit_elasticnet>0.5,"Si","No"),
hat_pobre_rfThresh_logit_elasticnet=ifelse(evalResults$Roc_logit_elasticnet>rfThresh_logit_elasticnet$threshold,"Si","No"),
hat_pobre_05_logit_elasticnet2=ifelse(evalResults$Roc_logit_elasticnet2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_elasticnet2=ifelse(evalResults$Roc_logit_elasticnet2>rfThresh_logit_elasticnet2$threshold,"Si","No"),
hat_pobre_05_logit_lasso_upsample=ifelse(evalResults$Roc_logit_lasso_upsample>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso_upsample=ifelse(evalResults$Roc_logit_lasso_upsample>rfThresh_logit_lasso_upsample$threshold,"Si","No"),
hat_pobre_05_logit_lasso_upsample2=ifelse(evalResults$Roc_logit_lasso_upsample2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso_upsample2=ifelse(evalResults$Roc_logit_lasso_upsample2>rfThresh_logit_lasso_upsample2$threshold,"Si","No"),
hat_pobre_05_logit_elasticnet_upsample=ifelse(evalResults$Roc_logit_elasticnet_upsample>0.5,"Si","No"),
hat_pobre_rfThresh_logit_elasticnet_upsample=ifelse(evalResults$Roc_logit_elasticnet_upsample>rfThresh_logit_elasticnet_upsample$threshold,"Si","No"),
hat_pobre_05_logit_elasticnet_upsample2=ifelse(evalResults$Roc_logit_elasticnet_upsample2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_elasticnet_upsample2=ifelse(evalResults$Roc_logit_elasticnet_upsample2>rfThresh_logit_elasticnet_upsample2$threshold,"Si","No"),
hat_pobre_05_logit_lasso_downsample=ifelse(evalResults$Roc_logit_lasso_downsample>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso_downsample=ifelse(evalResults$Roc_logit_lasso_downsample>rfThresh_logit_lasso_downsample$threshold,"Si","No"),
hat_pobre_05_logit_lasso_downsample2=ifelse(evalResults$Roc_logit_lasso_downsample2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso_downsample2=ifelse(evalResults$Roc_logit_lasso_downsample2>rfThresh_logit_lasso_downsample2$threshold,"Si","No"),
hat_pobre_05_logit_ridge_downsample=ifelse(evalResults$Roc_logit_ridge_downsample>0.5,"Si","No"),
hat_pobre_rfThresh_logit_ridge_downsample=ifelse(evalResults$Roc_logit_ridge_downsample>rfThresh_logit_ridge_downsample$threshold,"Si","No"),
hat_pobre_05_logit_ridge_downsample2=ifelse(evalResults$Roc_logit_ridge_downsample2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_ridge_downsample2=ifelse(evalResults$Roc_logit_ridge_downsample2>rfThresh_logit_ridge_downsample2$threshold,"Si","No")
with(evalResults,table(Pobre,hat_pobre_05_logit))
with(evalResults,table(Pobre, hat_pobre_05_logit))
with(evalResults,table(Pobre, hat_pobre_05))
with(evalResults,table(Pobre, hat_pobre_05_logit))
with(evalResults, table(Pobre, hat_pobre_05_logit))
with(evalResults, table(Pobre, hat_pobre_05_logit))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit))
with(evalResults,table(Pobre,hat_pobre_05_logit2))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit2))
with(evalResults,table(Pobre,hat_pobre_05_logit_lasso))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_lasso))
with(evalResults,table(Pobre,hat_pobre_05_logit_lasso2))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_lasso2))
with(evalResults,table(Pobre,hat_pobre_05_logit_ridge))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_ridge))
with(evalResults,table(Pobre,hat_pobre_05_logit_ridge2))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_ridge2))
with(evalResults,table(Pobre,hat_pobre_05_logit_elasticnet))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_elasticnet))
with(evalResults,table(Pobre,hat_pobre_05_logit_elasticnet2))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_elasticnet2))
with(evalResults,table(Pobre,hat_pobre_05_logit_lasso_upsample))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_lasso_upsample))
with(evalResults,table(Pobre,hat_pobre_05_logit_lasso_upsample2))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_lasso_upsample2))
with(evalResults,table(Pobre,hat_pobre_05_logit_ridge_upsample))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_ridge_upsample))
with(evalResults,table(Pobre,hat_pobre_05_logit_ridge_upsample2))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_ridge_upsample2))
with(evalResults,table(Pobre,hat_pobre_05_logit_elasticnet_upsample))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_elasticnet_upsample))
with(evalResults,table(Pobre,hat_pobre_05_logit_elasticnet_upsample2))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_elasticnet_upsample2))
with(evalResults,table(Pobre,hat_pobre_05_logit_lasso_downsample))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_lasso_downsample))
with(evalResults,table(Pobre,hat_pobre_05_logit_lasso_downsample2))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_lasso_downsample2))
with(evalResults,table(Pobre,hat_pobre_05_logit_ridge_downsample))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_ridge_downsample))
with(evalResults,table(Pobre,hat_pobre_05_logit_ridge_downsample2))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_ridge_downsample2))
with(evalResults,table(Pobre,hat_pobre_05_logit_elasticnet_downsample))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_elasticnet_downsample))
with(evalResults,table(Pobre,hat_pobre_05_logit_elasticnet_downsample2))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_elasticnet_downsample2))
with(evalResults,table(Pobre,hat_pobre_05_logit_lasso_smote))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_lasso_smote))
with(evalResults,table(Pobre,hat_pobre_05_logit_lasso_smote2))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_lasso_smote2))
with(evalResults,table(Pobre,hat_pobre_05_logit_ridge_smote))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_ridge_smote))
with(evalResults,table(Pobre,hat_pobre_05_logit_ridge_smote2))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_ridge_smote2))
with(evalResults,table(Pobre,hat_pobre_05_logit_elasticnet_smote))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_elasticnet_smote))
with(evalResults,table(Pobre,hat_pobre_05_logit_elasticnet_smote2))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit_elasticnet_smote2))
evalResults<-evalResults %>% mutate(hat_pobre_05_logit=ifelse(evalResults$Roc_logit>0.5,"Si","No"),
hat_pobre_rfThresh_logit=ifelse(evalResults$Roc_logit>rfThresh_logit$threshold,"Si","No"),
hat_pobre_05_logit2=ifelse(evalResults$Roc_logit2>0.5,"Si","No"),
hat_pobre_rfThresh_logit2=ifelse(evalResults$Roc_logit2>rfThresh_logit2$threshold,"Si","No"),
hat_pobre_05_logit_lasso=ifelse(evalResults$Roc_logit_lasso>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso=ifelse(evalResults$Roc_logit_lasso>rfThresh_logit_lasso$threshold,"Si","No"),
hat_pobre_05_logit_lasso2=ifelse(evalResults$Roc_logit_lasso2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso2=ifelse(evalResults$Roc_logit_lasso2>rfThresh_logit_lasso2$threshold,"Si","No"),
hat_pobre_05_logit_elasticnet=ifelse(evalResults$Roc_logit_elasticnet>0.5,"Si","No"),
hat_pobre_rfThresh_logit_elasticnet=ifelse(evalResults$Roc_logit_elasticnet>rfThresh_logit_elasticnet$threshold,"Si","No"),
hat_pobre_05_logit_elasticnet2=ifelse(evalResults$Roc_logit_elasticnet2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_elasticnet2=ifelse(evalResults$Roc_logit_elasticnet2>rfThresh_logit_elasticnet2$threshold,"Si","No"),
hat_pobre_05_logit_lasso_upsample=ifelse(evalResults$Roc_logit_lasso_upsample>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso_upsample=ifelse(evalResults$Roc_logit_lasso_upsample>rfThresh_logit_lasso_upsample$threshold,"Si","No"),
hat_pobre_05_logit_lasso_upsample2=ifelse(evalResults$Roc_logit_lasso_upsample2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso_upsample2=ifelse(evalResults$Roc_logit_lasso_upsample2>rfThresh_logit_lasso_upsample2$threshold,"Si","No"),
hat_pobre_05_logit_elasticnet_upsample=ifelse(evalResults$Roc_logit_elasticnet_upsample>0.5,"Si","No"),
hat_pobre_rfThresh_logit_elasticnet_upsample=ifelse(evalResults$Roc_logit_elasticnet_upsample>rfThresh_logit_elasticnet_upsample$threshold,"Si","No"),
hat_pobre_05_logit_elasticnet_upsample2=ifelse(evalResults$Roc_logit_elasticnet_upsample2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_elasticnet_upsample2=ifelse(evalResults$Roc_logit_elasticnet_upsample2>rfThresh_logit_elasticnet_upsample2$threshold,"Si","No"),
hat_pobre_05_logit_lasso_downsample=ifelse(evalResults$Roc_logit_lasso_downsample>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso_downsample=ifelse(evalResults$Roc_logit_lasso_downsample>rfThresh_logit_lasso_downsample$threshold,"Si","No"),
hat_pobre_05_logit_lasso_downsample2=ifelse(evalResults$Roc_logit_lasso_downsample2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_lasso_downsample2=ifelse(evalResults$Roc_logit_lasso_downsample2>rfThresh_logit_lasso_downsample2$threshold,"Si","No"),
hat_pobre_05_logit_ridge_downsample=ifelse(evalResults$Roc_logit_ridge_downsample>0.5,"Si","No"),
hat_pobre_rfThresh_logit_ridge_downsample=ifelse(evalResults$Roc_logit_ridge_downsample>rfThresh_logit_ridge_downsample$threshold,"Si","No"),
hat_pobre_05_logit_ridge_downsample2=ifelse(evalResults$Roc_logit_ridge_downsample2>0.5,"Si","No"),
hat_pobre_rfThresh_logit_ridge_downsample2=ifelse(evalResults$Roc_logit_ridge_downsample2>rfThresh_logit_ridge_downsample2$threshold,"Si","No"))
with(evalResults, table(Pobre, hat_pobre_05_logit))
with(evalResults,table(Pobre,hat_pobre_rfThresh_logit))
set.seed(1410)
tree <- train(
x = trainX,
y = training$Pobre,
method = "rpart",
trControl = ctrl,
parms=list(split='Gini'),
tuneLength=300
)
tree
